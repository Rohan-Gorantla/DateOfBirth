<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Date Input</title>
    <style>
      .date-input-container {
        display: inline-flex;
        border: 1px solid #ccc;
        border-radius: 4px;
        overflow: hidden;
      }

      .date-input-container input {
        border: none;
        outline: none;
        padding: 5px;
        text-align: center;
        font-size: 14px;
      }

      .date-input-container input:not(:last-child) {
        border-right: 1px solid #ccc;
      }

      .date-input-container input.error {
        border: 1px solid red;
      }

      #mm,
      #dd {
        width: 40px;
      }

      #yyyy {
        width: 60px;
      }

      .date-input-container input::placeholder {
        color: #aaa;
      }

      #error-message {
        color: red;
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }
    </style>
  </head>
  <body>
    <label for="dob">Enter Date:</label>
    <div class="date-input-container">
      <input
        type="text"
        id="mm"
        placeholder="MM"
        maxlength="2"
        oninput="this.value = this.value.replace(/[^0-9]/g, ''); moveToNext(this, 'dd')"
        onblur="validateDate()"
      />
      <input
        type="text"
        id="dd"
        placeholder="DD"
        maxlength="2"
        oninput="this.value = this.value.replace(/[^0-9]/g, ''); moveToNext(this, 'yyyy')"
        onblur="validateDate()"
        pattern="([0-9]{2})"
        onkeydown="handleBackspace(event, 'mm')"
      />
      <input
        type="text"
        id="yyyy"
        placeholder="YYYY"
        maxlength="4"
        pattern="([0-9]{4})"
        oninput="this.value = this.value.replace(/[^0-9]/g, ''); validateDate()"
        onkeydown="handleBackspace(event, 'dd')"
      />
    </div>
    <div id="error-message">Invalid date. Please enter a valid date.</div>

    <script>
      // Function to move focus to the next input
      function moveToNext(current, nextId) {
        if (current.value.length === current.maxLength) {
          document.getElementById(nextId).focus();
        }
      }

      // Function to handle backspace behavior
      function handleBackspace(event, previousId) {
        if (event.key === "Backspace" && event.target.value === "") {
          document.getElementById(previousId).focus();
        }
      }

      // Function to validate the date
      function validateDate() {
        const mm = document.getElementById("mm").value;
        const dd = document.getElementById("dd").value;
        const yyyy = document.getElementById("yyyy").value;
        const errorMessage = document.getElementById("error-message");

        // Only validate if all fields are filled
        if (mm.length === 2 && dd.length === 2 && yyyy.length === 4) {
          // Check for valid month (01-12)
          const month = parseInt(mm, 10);
          if (month < 1 || month > 12) {
            errorMessage.style.display = "block";
            applyErrorStyles();
            return;
          }

          // Check for valid day (01-31)
          const day = parseInt(dd, 10);
          if (day < 1 || day > 31) {
            errorMessage.style.display = "block";
            applyErrorStyles();
            return;
          }

          // Handle specific days based on month
          const daysInMonth = new Date(yyyy, month, 0).getDate();
          if (day > daysInMonth) {
            errorMessage.style.display = "block";
            applyErrorStyles();
            return;
          }

          // Check if the year is a valid 4-digit number between 1800 and current year
          const year = parseInt(yyyy, 10);
          const currentYear = new Date().getFullYear();
          if (year < 1800 || year > currentYear) {
            errorMessage.style.display = "block";
            applyErrorStyles();
            return;
          }

          // Check if the entered date is in the future
          const today = new Date();
          const enteredDate = new Date(`${yyyy}-${mm}-${dd}`);
          if (enteredDate > today) {
            errorMessage.style.display = "block";
            applyErrorStyles();
            return;
          }

          // If all conditions are met, consider it a valid date
          const dateString = `${yyyy}-${mm}-${dd}`;
          const date = new Date(dateString);

          if (
            date.getFullYear() === year &&
            date.getMonth() + 1 === month &&
            date.getDate() === day
          ) {
            errorMessage.style.display = "none"; // Hide error message
            removeErrorStyles();
          } else {
            errorMessage.style.display = "block"; // Show error message
            applyErrorStyles();
          }
        } else {
          errorMessage.style.display = "none"; // Hide error message for incomplete inputs
          removeErrorStyles();
        }
      }

      // Apply error styles to inputs
      function applyErrorStyles() {
        document.getElementById("mm").classList.add("error");
        document.getElementById("dd").classList.add("error");
        document.getElementById("yyyy").classList.add("error");
      }

      // Remove error styles from inputs
      function removeErrorStyles() {
        document.getElementById("mm").classList.remove("error");
        document.getElementById("dd").classList.remove("error");
        document.getElementById("yyyy").classList.remove("error");
      }
    </script>
  </body>
</html>
